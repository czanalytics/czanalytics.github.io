<!DOCTYPE html>
<html lang="en">

<head>
  <title>Price</title>
    <meta charset="utf-8" />
  <link rel="icon" type="image/x-icon" href="./favicon.png" />
    <link
        rel="stylesheet"
        href="https://pyscript.net/latest/pyscript.css"/>
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    <link rel="stylesheet" href="./assets/css/examples.css" />
</head>

<body>
<section class="pyscript">
  <div id="folium"></div>
   
<py-config>
  packages = [
  "https://cdn.holoviz.org/panel/0.14.3/dist/wheels/bokeh-2.4.3-py3-none-any.whl",
  "folium", "pandas", "numpy", "panel==0.13.1"]
  plugins = ["https://pyscript.net/latest/plugins/python/py_tutor.py"]
  [[fetch]]
        files = ["./price.py"]
</py-config>

<py-script>    
from price import approx # import price doesn't work

print( approx(1966.0526) )

#model_conf = co2_foo()
#ms = model_conf['models']
</py-script>    

<div class="grid grid-rows-4 p-4 bg-blue-100 border-2 justify-items-left">
  
   <div>      
        <select name="flight-mode" id="flight-mode-select">
            <option value="one">EUR</option>
            <option value="gbp">GBP</option>
            <option value="sek">SEK</option>
            <option value="sek">CHF</option>
            <option value="usd">USD</option>
        </select>
    </div>

    <div>
        <h4 class="font-semibold">From</h4>
        <input id="dep" class="w-3/4 bg-white border-4">
    </div>

    <div>
        <h4 class="font-semibold">To</h4>
        <input id="ret" class="w-3/4 bg-white border-4">
    </div>

    <div>
        <button id="book-flight" class="p-2 my-2 bg-green-200 border-2 border-gray-400 rounded-lg">Get Price</button>
        <p id="flight-info" class="italic"> Avg. price with 68% conf. range (low, high) </p>
    </div>
</div>

<!--  
-->

<py-script>
import js
from js import document
from pyodide.ffi import create_proxy

from price import price_est # !
from price import _flight_mode_change, _book_flight

flight_mode_change = create_proxy(_flight_mode_change)

document.getElementById("flight-mode-select").addEventListener("input", flight_mode_change)

book_flight = create_proxy(_book_flight)
document.getElementById("book-flight").addEventListener("click", book_flight)

flight_mode_change()
</py-script>

<py-script>
import pandas as pd

from price import get_data # !

d = get_data()

d_ = d.loc[(d['Origin'] == 'ES70') & (d['Destination'] == 'PT11') ]

print (d_)
</py-script>

</body>

